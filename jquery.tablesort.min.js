(function($){jQuery.fn.makeSortable=function(){this.each(function(n,o){var p=$(this).addClass("jquery-tablesort");if(p.get()[0].tagName.toUpperCase()=="TABLE"){$("th > *:first-child",p).each(function(k,l){var m=$(this);m.click(function(){var j=p.find("td table *");p.find("tbody").not(j).each(function(e,f){var g=$(f).find("tr").not(j);var h=[],sort_as=null;g.each(function(a,b){var c=h[a]=$(this).find("td").not(j).eq(k).text()+"";var d=(!isNaN(Date.parse(c))?"date":(!isNaN(new Number(c))?"number":(!isNaN(new Number(c.replace(/^\$/,"")))?"currency":"string")));sort_as=(!!sort_as&&sort_as!=d?"string":d)});g=g.sort(function(a,b){var c=$(a).find("td").not(j).eq(k).text();var d=$(b).find("td").not(j).eq(k).text();if(sort_as=="date"){c=Date.parse(c);d=Date.parse(d);return(c<d?-1:(c==d?0:1))}else if(sort_as=="currency"){return(c.replace(/^\$/,"")-d.replace(/^\$/,""))}else if(sort_as=="number"){return(c-d)}else if(sort_as=="string"){c=c.toString();d=d.toString();return(c<d?-1:(c==d?0:1))}else{return 0}});$(".sorort-asc").addClass("sort-desc")}else{m.removeClass("sort-desc").addClass("sort-asc")}$(f).append(g)});p.trigger('sort')})});p.trigger('sort')}});return this}})(jQuery);
